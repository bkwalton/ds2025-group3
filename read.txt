WITH zillow AS (
  SELECT 
    neighborhood,
    period,
    (SELECT AVG(value) FROM zillow WHERE neighborhood = zm.neighborhood AND period = zm.period ORDER BY value LIMIT 1 OFFSET (COUNT(*)/2)) as median_value
  FROM 
    zillow zm
),
WITH income AS (
  SELECT 
    i.neighborhood,
    i.value as income_median
  FROM 
    income i
  JOIN 
    tracts t ON i.tract = t.tract
),
unemployment AS (
  SELECT 
    u.neighborhood,
    u.value as unemployment_rate
  FROM 
    unemployment u
  JOIN 
    tracts t ON u.tract = t.tract
)
SELECT 
  zm.neighborhood,
  zm.median_value,
  i.income_median,
  u.unemployment_rate
FROM 
  zillow zm
JOIN 
  income i ON zm.neighborhood = i.neighborhood AND zm.period = i.period
JOIN 
  unemployment u ON zm.neighborhood = u.neighborhood AND zm.period = u.period
SELECT 
  zm.neighborhood,
  zm.median_value,
  i.income_median,
  u.unemployment_rate,
  d.distance,
  d.duration
FROM 
  zillow zm
JOIN 
  income i ON zm.neighborhood = i.neighborhood AND zm.period = i.period
JOIN 
  unemployment u ON zm.neighborhood = u.neighborhood AND zm.period = u.period
JOIN 
  (SELECT 
     neighborhood,
     distance,
     duration
   FROM 
     disney) d ON zm.neighborhood = d.neighborhood;